import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import type { SuspiciousAppInfo } from 'cordova-talsec-plugin-freerasp';

@Injectable({
  providedIn: 'root',
})
export class SuspiciousAppsService {
  private suspiciousAppsSubject = new BehaviorSubject<SuspiciousAppInfo[]>([]);
  suspiciousApps$ = this.suspiciousAppsSubject.asObservable();

  setSuspiciousApps(apps: SuspiciousAppInfo[]) {
    this.suspiciousAppsSubject.next(apps);
  }

  getSuspiciousApps() {
    return this.suspiciousAppsSubject.getValue();
  }
}
